<%- include('partials/header') -%>
    <h1><%= userName.charAt(0).toUpperCase() + userName.slice(1) + "'s"%> Books (<%= books.length %>)</h1>
    <table id="table" class="centered striped responsive-table">
        <thead class="orange lighten-4">
            <tr>
                <th>Book Title</th>
                <th>Author Name</th>
                <th>Rating</th>
                <th>Added</th>
                <th>Delete</th>
                <th>Favorite</th>
            </tr>
        </thead>
        <tr>
            <% for(let i=0; i < books.length; i++) {%>
                    <td><%= books[i].title %></td>
                    <td><%= books[i].author %></td>
                    <td><%= books[i].rating %></td>
                    <td><%= books[i].createdAt.toLocaleDateString() %></td>
                    <td>
                    <%if(books.user == user.id){ %>
                      <div id="modal1" class="modal">
                        <div class="modal-content">
                          <p>Are you sure you want to delete this entry?</p>
                        </div>
                        <div class="modal-footer">
                          <form action="books/deleteBook/<%=books[i]._id%>?_method=DELETE" method="POST">
                            <button class="btn light-blue darken-4"       type="submit">Agree</button>
                            <span class="modal-close btn light-blue darken-4">Cancel</span>
                          </form>
                        </div>
                      </div>
                        <button class="btn modal-trigger light-blue darken-4 fa fa-trash" href="#modal1" type="submit"></button>
                    </td>
                    <td><form
                        class="col-1"
                        action="books/markFavorite/<%=books[i]._id%>?_method=PUT"
                        method="POST"
                      >
                        <button id="favorite" class="btn light-blue darken-4 fa fa-heart" onclick="M.toast({html: 'Added to favorites!'})" type="submit"></button>
                      </form>
                    </td>
                    <%}%>
                </tr>
                <% } %>
    </table>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

    <script>
            document.addEventListener('DOMContentLoaded', function() {
            var modal = document.querySelectorAll('.modal');
            var instances = M.Modal.init(modal);
          });
    </script>
<%- include('partials/footer') -%>